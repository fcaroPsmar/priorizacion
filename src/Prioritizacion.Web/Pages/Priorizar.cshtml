@page
@model PriorizarModel
@{
  ViewData["Title"] = "Priorizar";
}

<div class="card">
  <h1>Prioriza tus plazas</h1>

  @if (!string.IsNullOrWhiteSpace(Model.Success))
  {
    <div class="success">@Model.Success</div>
  }
  @if (!string.IsNullOrWhiteSpace(Model.Error))
  {
    <div class="alert">@Model.Error</div>
  }

  <p class="muted">Arrastra y suelta para subir/bajar plazas. El número se actualiza automáticamente.</p>

  <form method="post">
    <input type="hidden" id="orderedIds" name="OrderedIds" value="@Model.OrderedIds" />

    <ul id="plazas-list" class="plazas">
      @foreach (var it in Model.Items)
      {
        <li class="plaza" draggable="true" data-plaza-id="@it.PlazaId">
          <span class="order-badge">@it.Orden</span>
          <div class="plaza-body">
            <div class="plaza-title">@it.Titulo</div>
            <div class="plaza-sub">@it.Centre</div>
          </div>
          <button type="button" class="delete-button" title="Eliminar plaza" aria-label="Eliminar plaza">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M9 3h6l1 2h4v2H4V5h4l1-2zm1 6h2v9h-2V9zm4 0h2v9h-2V9zM7 9h2v9H7V9zm1 12h8a2 2 0 0 0 2-2V9H6v10a2 2 0 0 0 2 2z" />
            </svg>
          </button>
          <span class="drag-handle" title="Arrastrar">↕</span>
        </li>
      }
    </ul>

    <div class="actions">
      <button class="btn" type="submit" asp-page-handler="Guardar">Guardar</button>
      <button class="btn secondary" type="submit" asp-page-handler="Reiniciar">Reiniciar</button>
      <button class="btn danger" type="submit" asp-page-handler="Enviar" onclick="return confirm('¿Enviar definitivamente? Después no podrás volver a entrar.');">Enviar</button>
    </div>

    <p class="muted small">Guardar y Reiniciar solo funcionan mientras la convocatoria esté abierta. Enviar cierra tu participación.</p>
  </form>
</div>

@section Scripts {
  <script src="~/js/priorizar.js"></script>
}
